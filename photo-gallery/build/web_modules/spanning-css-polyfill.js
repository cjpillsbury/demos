function z(b,d){(null==d||d>b.length)&&(d=b.length);for(var a=0,f=new Array(d);a<d;a++)f[a]=b[a];return f}var t=function(){try{var b=function(){if(!w)return w=!0,Promise.resolve(Promise.resolve(!1)).then(function(d){w=d,window[j].dispatchEvent(new Event("change"))})}();return Promise.resolve(b&&b.then?b.then(function(){}):void 0)}catch(d){return Promise.reject(d)}},j="__foldables__",w=!1,A=function(){function b(){var a=this;if(void 0!==window[j])return window[j];var f=document.createDocumentFragment();this.addEventListener=f.addEventListener.bind(f),this.removeEventListener=f.removeEventListener.bind(f),this.dispatchEvent=function(c){if("change"===c.type){var e="on"+c.type;return"function"==typeof a[e]&&a[e](c),f.dispatchEvent(c)}},window.addEventListener("message",function(c){"update"===c.data.action&&Object.assign(a,c.data.value)}),window.addEventListener("resize",function(){return function(c,e){var g;return function(){var h=arguments,i=this;clearTimeout(g),g=setTimeout(function(){return c.apply(i,h)},200)}}(t())})}var d;return b.prototype.getSegments=function(){if("none"===this.spanning)return[{left:0,top:0,width:window.innerWidth,height:window.innerHeight}];if("single-fold-horizontal"===this.spanning){var a=(window.innerHeight-this.browserShellSize)/2,f=window.innerWidth;return[{top:0,left:0,width:f,height:a-this.foldSize/2},{top:a-this.foldSize/2,height:this.foldSize,left:0,width:f},{top:a+this.foldSize/2,left:0,width:f,height:a-this.foldSize/2}]}if("single-fold-vertical"===this.spanning){var c=window.innerWidth/2-this.foldSize/2,e=window.innerHeight;return[{top:0,left:0,width:c,height:e},{top:0,height:e,left:c,width:this.foldSize},{top:0,left:window.innerWidth/2+this.foldSize/2,width:c,height:e}]}},(d=[{key:"spanning",get:function(){return sessionStorage.getItem(j+"-spanning")||"none"},set:function(a){if(!["none","single-fold-horizontal","single-fold-vertical"].includes(a))throw new TypeError(a);sessionStorage.setItem(j+"-spanning",a),t()}},{key:"foldSize",get:function(){return+sessionStorage.getItem(j+"-fold-size")||0},set:function(a){if(!(Number(a)>=0))throw new TypeError(a);sessionStorage.setItem(j+"-fold-size",a),t()}},{key:"browserShellSize",get:function(){return+sessionStorage.getItem(j+"-browser-shell-size")||0},set:function(a){if(!(Number(a)>=0))throw new TypeError(a);sessionStorage.setItem(j+"-browser-shell-size",a),t()}}])&&function(a,f){for(var c=0;c<f.length;c++){var e=f[c];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,e.key,e)}}(b.prototype,d),b}();window[j]=new A(),void 0===window.getWindowSegments&&(window.getWindowSegments=function(){var b=window[j].getSegments();return 1===b.length?b:[b[0],b[2]]});var I=/\((.*?)\)/gi,J=/@media[^\(]+/gi;function B(b,d){return b.replace(new RegExp("(\\s*)(@media.*?\\bspanning\\b[^{]+)\\{([\\s\\S]+?\\})(\\s*)\\}","gi"),d)}function C(b){var d,a=function(c){var e,g=new RegExp("(\\s*)(@media.*?\\bspanning\\b[^{]+)\\{([\\s\\S]+?\\})(\\s*)\\}","gi");if("function"==typeof c.matchAll)e=Array.from(c.matchAll(g));else{for(e=[];e[e.length]=g.exec(c););e.length--}return e}(b),f=((d={})["single-fold-horizontal"]="",d["single-fold-vertical"]="",d.none="",d);return a.forEach(function(c){var e=c[1],g=c[2],h=c[3],i=c[4],k="none";g.indexOf("single-fold-horizontal")>-1&&(k="single-fold-horizontal"),g.indexOf("single-fold-vertical")>-1&&(k="single-fold-vertical");var l=g.match(J)||[],m=function(p){return p.match(I)||[]}(g);m=m.filter(function(p){return!p.includes("spanning")}).join(" and "),f[k]+=""+e+l+m+"{"+h+i+"}"}),f}var u=window.matchMedia("(spanning: single-fold-horizontal)").matches||window.matchMedia("(spanning: single-fold-vertical)").matches||window.matchMedia("(spanning: none)").matches||!1;console.info("CSS Spanning Media Queries are supported? "+u);var D,x=new A();if(!u){var y=Array.from(document.querySelectorAll('link[rel="stylesheet"], style'));(D=y,Promise.all(D.map(function(b){return b.href?fetch(b.href).then(function(d){return d.text()}):b.textContent}))).then(function(b){var d=new DocumentFragment();b.forEach(function(a,f){for(var c=B(a,""),e=C(a),g=y[f].href||"inline",h=0,i=Object.entries(e);h<i.length;h++){var k=i[h];o[k[0]]+="/* origin: "+g+" */"+k[1]}var l=document.createElement("style");l.setAttribute("data-css-origin",g),l.textContent=c,d.appendChild(l)}),y.forEach(function(a){return null!=a.parentElement&&a.parentElement.removeChild(a)}),document.head.appendChild(d),E()})}var o={"single-fold-horizontal":"","single-fold-vertical":"",none:""};function K(b,d){if(u)return b;var a=B(b,""),f=C(b);d&&(o[d]={"single-fold-horizontal":"","single-fold-vertical":"",none:""});for(var c=d?o[d]:o,e=d?"":"/* origin: inline */",g=0,h=Object.entries(f);g<h.length;g++){var i=h[g];c[i[0]]+=""+e+i[1]}return c["non-spanning"]=a,a}function E(b){u||(F(b),x.addEventListener("change",function(){return F(b)}))}function F(b){for(var d=x,a=b?o[b.nodeName.toLowerCase()][d.spanning]:o[d.spanning],f=b?o[b.nodeName.toLowerCase()]["non-spanning"]:null,c=x.getSegments(),e=0,g=Object.entries(1===c.length?{}:c[1]);e<g.length;e++){var h=g[e];i=h[1]+"px",a=a.replace(new RegExp("env\\(\\s*fold-"+h[0]+"\\s*\\)","gi"),i)}var i,k="__foldables_sheet__",l=function(p,L){for(var G,M=function(q,N){var s;if("undefined"==typeof Symbol||null==q[Symbol.iterator]){if(Array.isArray(q)||(s=function(n,O){if(n){if("string"==typeof n)return z(n,void 0);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(n,void 0):void 0}}(q))){s&&(q=s);var H=0;return function(){return H>=q.length?{done:!0}:{done:!1,value:q[H++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(s=q[Symbol.iterator]()).next.bind(s)}(p.querySelectorAll("."+k));!(G=M()).done;)G.value.remove();var v=document.createElement("style");v.className=k,v.textContent=L,p===document?document.head.appendChild(v):p.appendChild(v)};if(b){var m=b.shadowRoot;"adoptedStyleSheets"in m&&m.adoptedStyleSheets.length>0?m.adoptedStyleSheets[0].replace(f+a):l(m,a)}else l(document,a)}export{K as adjustCSS,E as observe};
